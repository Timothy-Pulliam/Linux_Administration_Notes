Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-06-05T11:55:32-04:00

====== nmcli ======
Created Tuesday 05 June 2018

nmcli sucks

==== Overview ====
#nmcli con show <device> 

Shows the settings set for the particular connection.  Lower case options are user set, capitalized options are set by DHCP.
https://lists.centos.org/pipermail/centos/2016-April/158727.html


==== Disabling Auto DNS ====

Often times, [[NetworkManager]] will autoconfigure DNS settings from your DHCP client. You may not want this. This will be apparent when you cat out [[/etc/resolv.conf]] and you see stuff in there you don't want, but it is not present in any [[/etc/sysconfig/network-scripts.]] To disable simply, turn off auto dns, then reset the device.

'''
[root@dns named]# nmcli connection modify enp0s3 ipv4.ignore-auto-dns TRUE
[root@dns named]# nmcli connection up enp0s3
'''
 

Cat out [[/etc/resolv.conf,]] and you should see your desired dns server.

'''
[root@dns named]# cat /etc/resolv.conf 
# Generated by NetworkManager
search home
nameserver 192.168.1.148
'''



==== Troubleshooting ====

== Dropped packets / No route to host ==

Make sure you have both the default gateway AND netmask / prefix set. Otherwise the host will not be visible on the network. Then reset the connection.

[root@dns ~]# nmcli con modify enp0s3 ipv4.addresses 192.168.1.190/24 ipv4.gateway 192.168.1.1
[root@dns ~]# nmcli con up enp0s3
Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/8)
